<!-- Contact Support Modal -->
<div *ngIf="isVisible" class="modal-overlay">
  <div class="modal-container">
    <!-- Success State -->
    <div *ngIf="showSuccess" class="success-state">
      <div class="success-icon">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
        </svg>
      </div>
      <h2 class="success-title">{{ 'SUPPORT_REQUEST_SENT' | translate }}</h2>
      <p class="success-message">{{ 'SUPPORT_EMAIL_CLIENT_OPENED' | translate }}</p>
    </div>

    <!-- Form State -->
    <div *ngIf="!showSuccess" class="form-state">
      <!-- Header -->
      <div class="modal-header">
        <div class="header-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192l-3.536 3.536M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0z"></path>
          </svg>
        </div>
        <h2 class="modal-title">{{ 'CONTACT_SUPPORT' | translate }}</h2>
        <button class="close-button" (click)="closeModal()" type="button">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>

      <!-- Info Box -->
      <div class="info-box">
        <div class="info-icon">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          </svg>
        </div>
        <div class="info-text">
          <p class="info-label">{{ 'SUPPORT_EMAIL_LABEL' | translate }}</p>
          <p class="info-value">{{ supportEmail }}</p>
        </div>
      </div>

      <!-- Form -->
      <form [formGroup]="supportForm" (ngSubmit)="onSubmit()" class="support-form">
        <!-- Subject Field -->
        <div class="form-group">
          <label for="subject" class="form-label">
            {{ 'SUBJECT' | translate }} <span class="required">*</span>
          </label>
          <input
            id="subject"
            type="text"
            formControlName="subject"
            class="form-input"
            placeholder="{{ 'BRIEF_DESCRIPTION_PLACEHOLDER' | translate }}"
            [class.invalid]="supportForm.get('subject')?.invalid && supportForm.get('subject')?.touched"
          />
          <div *ngIf="supportForm.get('subject')?.invalid && supportForm.get('subject')?.touched" class="error-message">
            {{ 'SUBJECT_REQUIRED' | translate }}
          </div>
        </div>

        <!-- Message Field -->
        <div class="form-group">
          <label for="message" class="form-label">
            {{ 'MESSAGE' | translate }} <span class="required">*</span>
          </label>
          <textarea
            id="message"
            formControlName="message"
            rows="6"
            class="form-textarea"
            placeholder="{{ 'BRIEF_DESCRIPTION_PLACEHOLDER' | translate }}"
            [class.invalid]="supportForm.get('message')?.invalid && supportForm.get('message')?.touched"
          ></textarea>
          <div *ngIf="supportForm.get('message')?.invalid && supportForm.get('message')?.touched" class="error-message">
            {{ 'MESSAGE_REQUIRED' | translate }}
          </div>
          <p class="help-text">{{ 'HELP_PROVIDE_DETAILS' | translate }}</p>
        </div>

        <!-- User Info Display -->
        <div class="user-info-box">
          <svg class="user-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
          </svg>
          <span>{{ 'YOUR_EMAIL' | translate }} <strong>{{ userEmail }}</strong></span>
        </div>

        <!-- Action Buttons -->
        <div class="button-group">
          <button
            type="submit"
            [disabled]="supportForm.invalid || isSubmitting"
            class="submit-button"
          >
            <svg *ngIf="!isSubmitting" class="button-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
            </svg>
            <div *ngIf="isSubmitting" class="spinner"></div>
            <span>{{ isSubmitting ? ('SENDING' | translate) : ('SEND_SUPPORT_EMAIL' | translate) }}</span>
          </button>
          
          <button
            type="button"
            (click)="closeModal()"
            class="cancel-button"
            [disabled]="isSubmitting"
          >
            {{ 'CANCEL' | translate }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
